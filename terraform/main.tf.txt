# main.tf

# GKE Cluster Resource
resource "google_container_cluster" "primary" {
  name     = var.cluster_name
  location = var.region
  
  # For low cost/free tier: set initial node count to 1 (or less)
  initial_node_count = 1 

  # Configuration for the default node pool
  node_config {
    machine_type = var.machine_type
    disk_size_gb = 10
    
    # Standard GKE service account permissions for logging/monitoring
    oauth_scopes = [
      "https://www.googleapis.com/auth/cloud-platform",
    ]
  }

  # Enable a release channel for automatic version updates (recommended)
  release_channel {
    channel = "REGULAR" 
  }

  deletion_protection = false # Set to true for production to prevent accidental deletion
}